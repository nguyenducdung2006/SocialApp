<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang ch·ªß - Social App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{/css/home.css}">
</head>

<!-- D√πng data-homebg thay th:style ƒë·ªÉ tr√°nh l·ªói SpEL 100k chars -->
<body th:attr="data-homebg=${sessionUser != null and sessionUser.equippedHomeBg != null ?
    sessionUser.equippedHomeBg : ''}">

<!-- Overlay m·ªù khi c√≥ n·ªÅn ‚Äî JS s·∫Ω b·∫≠t l√™n n·∫øu c√≥ BG -->
<div id="homeBgOverlay"
     style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:0;pointer-events:none;"></div>

<!-- B·ªçc to√†n b·ªô content -->
<div style="position:relative;z-index:1;">

    <!-- NAVBAR -->
    <nav class="top-navbar">
        <a class="brand" th:href="@{/home}">‚ú¶ SocialApp</a>
        <div class="search-wrap d-none d-md-flex">
            <i class="bi bi-search"></i>
            <input type="text" class="search-input" placeholder="T√¨m ki·∫øm t√°c ph·∫©m, ng∆∞·ªùi d√πng...">
        </div>
        <div class="nav-spacer"></div>
        <div class="d-flex align-items-center gap-2">
            <a th:href="@{/notifications}" class="nav-icon text-decoration-none">
                <i class="bi bi-bell"></i>
                <span class="notif-badge">3</span>
            </a>
            <a th:href="@{/chat}" class="nav-icon text-decoration-none">
                <i class="bi bi-chat-dots"></i>
                <span class="notif-badge">5</span>
            </a>
            <a th:href="@{/upload}" class="upload-btn text-decoration-none">
                <i class="bi bi-cloud-upload"></i> ƒêƒÉng t·∫£i
            </a>
            <a th:href="@{/profile}" class="text-decoration-none">
                <div class="avatar-nav"
                     th:if="${sessionUser != null and sessionUser.avatarData != null}"
                     style="overflow:hidden;padding:0;">
                    <img th:src="@{/profile/avatar/{id}(id=${sessionUser.id})}"
                         style="width:100%;height:100%;border-radius:50%;object-fit:cover;" alt="avatar">
                </div>
                <div class="avatar-nav"
                     th:if="${sessionUser == null or sessionUser.avatarData == null}"
                     th:text="${sessionUser != null ? sessionUser.username.substring(0,1).toUpperCase() : 'U'}">U</div>
            </a>
            <a th:href="@{/wallet/recharge}" class="nav-icon text-decoration-none" title="N·∫°p ti·ªÅn">
                <i class="bi bi-wallet2"></i>
            </a>
            <a th:href="@{/auth/logout}" class="nav-icon text-decoration-none" title="ƒêƒÉng xu·∫•t">
                <i class="bi bi-box-arrow-right"></i>
            </a>
        </div>
    </nav>

    <!-- TAB BAR -->
    <div class="tab-bar">
        <a th:href="@{/home}" class="tab-link active">D√†nh cho b·∫°n</a>
        <a th:href="@{/home?tab=new}" class="tab-link">M·ªõi nh·∫•t</a>
        <a th:href="@{/home?tab=following}" class="tab-link">ƒêang theo d√µi</a>
        <a th:href="@{/home?tab=popular}" class="tab-link">Ph·ªï bi·∫øn</a>
        <a th:href="@{/ranking}" class="tab-link">Ranking</a>
    </div>

    <!-- MAIN LAYOUT -->
    <div class="page-layout">

        <!-- LEFT SIDEBAR -->
        <div class="left-sidebar d-none d-xl-block">
            <div class="sidebar-section">
                <div class="sidebar-label">Kh√°m ph√°</div>
                <a th:href="@{/home}" class="sidebar-link active">
                    <i class="bi bi-house-fill"></i> Trang ch·ªß
                </a>
                <a th:href="@{/trending}" class="sidebar-link">
                    <i class="bi bi-fire"></i> Xu h∆∞·ªõng
                </a>
                <a th:href="@{/ranking}" class="sidebar-link">
                    <i class="bi bi-trophy-fill"></i> B·∫£ng x·∫øp h·∫°ng
                </a>
                <a th:href="@{/saved}" class="sidebar-link">
                    <i class="bi bi-bookmark-fill"></i> ƒê√£ l∆∞u
                </a>
                <a th:href="@{/liked}" class="sidebar-link">
                    <i class="bi bi-heart-fill"></i> Y√™u th√≠ch
                </a>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-label">Tags ph·ªï bi·∫øn</div>
                <div class="tag-list">
                    <span class="tag">#illustration</span>
                    <span class="tag">#anime</span>
                    <span class="tag">#fanart</span>
                    <span class="tag">#digital</span>
                    <span class="tag">#sketch</span>
                    <span class="tag">#portrait</span>
                    <span class="tag">#nature</span>
                    <span class="tag">#fantasy</span>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="sec-header">
                <span class="sec-title">‚ú® M·ªõi nh·∫•t h√¥m nay</span>
                <a th:href="@{/home?tab=new}" class="sec-all">Xem t·∫•t c·∫£ ‚Üí</a>
            </div>
            <div class="img-grid" id="mainGrid">
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art1/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="1"><i class="bi bi-heart"></i> 128</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">B·ª©c tranh m√πa thu</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#e94560;">A</div>@artist_a
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 1.2k</span></div>
                        </div>
                    </div>
                </div>
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art2/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="2"><i class="bi bi-heart"></i> 342</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">Fantasy Character</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#a855f7;">B</div>@artist_b
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 3.5k</span></div>
                        </div>
                    </div>
                </div>
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art3/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="3"><i class="bi bi-heart"></i> 89</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">Ocean Dreams</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#4facfe;">C</div>@artist_c
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 890</span></div>
                        </div>
                    </div>
                </div>
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art4/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="4"><i class="bi bi-heart"></i> 512</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">Spring Vibes</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#43e97b;">D</div>@artist_d
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 4.1k</span></div>
                        </div>
                    </div>
                </div>
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art5/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="5"><i class="bi bi-heart"></i> 267</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">Sunset Warrior</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#fa709a;">E</div>@artist_e
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 2.3k</span></div>
                        </div>
                    </div>
                </div>
                <div class="img-card">
                    <img src="https://picsum.photos/seed/art6/300/300" class="img-thumb" alt="">
                    <div class="img-overlay">
                        <button class="overlay-btn like-btn" data-id="6"><i class="bi bi-heart"></i> 401</button>
                        <button class="overlay-btn save-btn"><i class="bi bi-bookmark"></i></button>
                    </div>
                    <div class="img-info">
                        <div class="img-title">Purple Galaxy</div>
                        <div class="img-meta">
                            <div class="img-author">
                                <div class="author-dot" style="background:#a18cd1;">F</div>@artist_f
                            </div>
                            <div class="img-stats"><span><i class="bi bi-eye"></i> 3.8k</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mb-4">
                <button class="load-more-btn" id="loadMoreBtn">
                    <i class="bi bi-arrow-clockwise me-2"></i>T·∫£i th√™m
                </button>
            </div>

            <!-- RANKING -->
            <div class="sec-header">
                <span class="sec-title">üèÜ Ranking h√¥m nay</span>
                <a th:href="@{/ranking}" class="sec-all">Xem t·∫•t c·∫£ ‚Üí</a>
            </div>
            <div class="ranking-grid">
                <div class="rank-card">
                    <span class="rank-num r1">1</span>
                    <img src="https://picsum.photos/seed/rank1/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">Fantasy Character Design</div>
                        <div class="rank-author">@artist_b</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 3.4k</span>
                </div>
                <div class="rank-card">
                    <span class="rank-num r2">2</span>
                    <img src="https://picsum.photos/seed/rank2/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">Sunset Warrior Epic</div>
                        <div class="rank-author">@artist_e</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 2.8k</span>
                </div>
                <div class="rank-card">
                    <span class="rank-num r3">3</span>
                    <img src="https://picsum.photos/seed/rank3/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">Purple Galaxy Art</div>
                        <div class="rank-author">@artist_f</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 2.1k</span>
                </div>
                <div class="rank-card">
                    <span class="rank-num r4">4</span>
                    <img src="https://picsum.photos/seed/rank4/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">Ocean Dreams Series</div>
                        <div class="rank-author">@artist_c</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 1.9k</span>
                </div>
                <div class="rank-card">
                    <span class="rank-num r5">5</span>
                    <img src="https://picsum.photos/seed/rank5/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">Spring Vibes Collection</div>
                        <div class="rank-author">@artist_d</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 1.5k</span>
                </div>
                <div class="rank-card">
                    <span class="rank-num r6">6</span>
                    <img src="https://picsum.photos/seed/rank6/60/60" class="rank-img" alt="">
                    <div class="rank-info">
                        <div class="rank-title">M√πa Thu Painting</div>
                        <div class="rank-author">@artist_a</div>
                    </div>
                    <span class="rank-likes"><i class="bi bi-heart-fill"></i> 1.2k</span>
                </div>
            </div>
        </div>

        <!-- RIGHT SIDEBAR -->
        <div class="right-sidebar d-none d-lg-block">
            <div class="widget">
                <a th:href="@{/profile}" class="text-decoration-none">
                    <div class="profile-top">
                        <div class="profile-avatar"
                             th:if="${sessionUser != null and sessionUser.avatarData != null}"
                             style="overflow:hidden;padding:0;">
                            <img th:src="@{/profile/avatar/{id}(id=${sessionUser.id})}"
                                 style="width:100%;height:100%;object-fit:cover;border-radius:50%;" alt="avatar">
                        </div>
                        <div class="profile-avatar"
                             th:if="${sessionUser == null or sessionUser.avatarData == null}"
                             th:text="${sessionUser != null ? sessionUser.username.substring(0,1).toUpperCase() : 'U'}">U</div>
                        <div class="profile-name"
                             th:text="${sessionUser != null ? (sessionUser.fullName != null ? sessionUser.fullName : sessionUser.username) : 'Ng∆∞·ªùi d√πng'}">Ng∆∞·ªùi d√πng</div>
                        <div class="profile-username"
                             th:text="${sessionUser != null ? '@' + sessionUser.username : '@username'}">@username</div>
                    </div>
                </a>
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-num">24</div>
                        <div class="stat-label">T√°c ph·∫©m</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-num">1.2k</div>
                        <div class="stat-label">Followers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-num">348</div>
                        <div class="stat-label">Following</div>
                    </div>
                </div>
                <div class="d-flex gap-2 mt-2">
                    <a th:href="@{/shop}" class="btn btn-sm btn-outline-warning w-50">
                        <i class="bi bi-shop"></i> Shop
                    </a>
                    <a th:href="@{/wallet/recharge}" class="btn btn-sm btn-outline-success w-50">
                        <i class="bi bi-wallet2"></i> N·∫°p ti·ªÅn
                    </a>
                </div>
            </div>

            <div class="widget">
                <div class="widget-title">G·ª£i √Ω theo d√µi</div>
                <div class="suggest-list">
                    <div class="suggest-item">
                        <div class="suggest-avatar" style="background:#e94560;">A</div>
                        <div class="suggest-info">
                            <div class="suggest-name">Artist Alpha</div>
                            <div class="suggest-sub">1.4k followers</div>
                        </div>
                        <button class="follow-btn">Theo d√µi</button>
                    </div>
                    <div class="suggest-item">
                        <div class="suggest-avatar" style="background:#a855f7;">B</div>
                        <div class="suggest-info">
                            <div class="suggest-name">Artist Beta</div>
                            <div class="suggest-sub">892 followers</div>
                        </div>
                        <button class="follow-btn">Theo d√µi</button>
                    </div>
                    <div class="suggest-item">
                        <div class="suggest-avatar" style="background:#4facfe;">C</div>
                        <div class="suggest-info">
                            <div class="suggest-name">Artist Cyan</div>
                            <div class="suggest-sub">2.1k followers</div>
                        </div>
                        <button class="follow-btn">Theo d√µi</button>
                    </div>
                </div>
            </div>

            <div class="widget">
                <div class="widget-title">Tags hot h√¥m nay</div>
                <div class="tag-list">
                    <span class="tag">#illustration</span>
                    <span class="tag">#anime</span>
                    <span class="tag">#fanart</span>
                    <span class="tag">#digital</span>
                    <span class="tag">#sketch</span>
                    <span class="tag">#portrait</span>
                </div>
            </div>
        </div>
    </div><!-- end page-layout -->

    <!-- LIGHTBOX -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-close" id="lightboxClose"><i class="bi bi-x-lg"></i></div>
        <img src="" id="lightboxImg" alt="">
    </div>

</div><!-- end z-index wrapper -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/home.js}"></script>
</body>
</html>
